---
title: "lab05"
author: "Dylan Scoble"
date: "2/17/2022"
output: html_document
---

The Github repository for this assignment is https://github.com/dscoble/lab05

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stringr)
library(knitr)
library(skimr)
library(broom)
```


```{r}
airbnb <- read_csv("listings.csv")
```

# Exploratory Data Analysis (EDA)

### Exercise 1
```{r}
airbnb <- airbnb %>% 
  mutate(cleaning_fee = price * 0.02)

glimpse(airbnb)
```

### Exercise 2
```{r}
ggplot(data = airbnb, aes(x = cleaning_fee)) +
  geom_histogram() +
  labs(x = "Cleaning Fee",
       y = "Number of Observations",
       title = "Histogram of Cleaning Fee")
```

```{r}
airbnb %>% 
  summarise(mean = mean(cleaning_fee),
            median = median(cleaning_fee),
            std_dev = sd(cleaning_fee),
            iqr = IQR(cleaning_fee))
```

The distribution of cleaning fee seems to be skewed to the right. There are multiple cases of outliers, which skews the mean value to be significantly larger than the median value.

### Exercise 3

```{r}
count(airbnb, neighbourhood)
```

There are five different categories of neighbourhood in the dataset, as shown by the table above.
The three most common neighbourhoods represented in this dataset are "Unincorporated Areas", "City of Santa Cruz", and "City of Capitola". These three neighbourhoods make up 97.25% of the total number of observations.


### Exercise 4

```{r}
airbnb <- airbnb %>% 
  mutate(neigh_simp = fct_lump_n(neighbourhood, n=3))
count(airbnb, neigh_simp)
```

### Exercise 5

```{r}
count(airbnb, minimum_nights)
```

The four most common values for the minimum_nights variable are 1, 2, 3, and 30. The seemingly unusual value of 30 minimum nights can be easily explained by the fact that these rentals are designated for long-term residents only, not tourists.

```{r}
airbnb <- airbnb %>% 
  filter(minimum_nights <= 3)
count(airbnb,minimum_nights)
```


# Regression

### Exercise 6

```{r}
airbnb <- airbnb %>% 
  mutate(price_3_nights = price * 3 + cleaning_fee)

```

### Exercise 7

```{r}
model <- lm(price_3_nights ~ neigh_simp + number_of_reviews + reviews_per_month, data = airbnb)

tidy(model, conf.int = TRUE) %>%
  kable(format = "markdown", digits = 3)
```

### Exercise 8

The coefficient of number_of_reviews in the model above shows that as the number of reviews is increased, the price of a three night stay decreases at a rate of $0.437 per review.

The confidence interval of number_of_reviews shows that in a repeated sampling of the data, the sample coefficient of number of reviews was between -0.834 and -0.040 95% of the time. In other words, we are 95% confident that the number of reviews affects the price of a three night stay at a rate between -\$0.834 and -$0.04

### Exercise 9

The coefficient of neigh_simpCity of Santa Cruz in the model above shows that compared to listings in the City of Capitola, the price of a three night stay in the City of Santa Cruz is  $208 cheaper on average.

The confidence interval of neigh_simpCity of Santa Cruz shows that in a repeated sampling of the data, the sample coefficient of listings in the City of Santa Cruz was between -356.966 and	-59.036 95% of the time. In other words, we are 95% confident that the price of a three night stay in the City of Santa Cruz is between \$356.966	and $59.036 cheaper.

### Exercise 10

The intercept of this model represents data for the city of Capitola. For example, the coefficient of the intercept represents the mean price of three nights in Capitola. The rest of the model's coefficients and confidence intervals are all dependent on the intercept, which makes the intercept meaningful.


